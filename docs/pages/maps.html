<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Maps</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <link rel="stylesheet" href="https://nesanders.github.io/cawastemap/theme/css/main.3dad1b7a.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
<meta property="og:title" content="The California Map of Hazardous Waste Sites and Schools - Maps">
  <meta property="og:description" content="What are hazardous waste facilities? What are the health impacts? Hazardous waste facilities are regulated sites that are allowed to produce, treat, store, and dispose hazardous waste. In addition...">
<meta property="og:url" content="https://nesanders.github.io/cawastemap/pages/maps.html">
<meta name="twitter:card" content="summary">
<meta property="og:site_name" content="The California Map of Hazardous Waste Sites and Schools">
<meta property="og:type" content="article">
  <meta property="article:section" content="pages">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="navbar">
        <div class="navbar-brand">
          <a class="navbar-item title is-3"
             href="https://nesanders.github.io/cawastemap/">The California Map of Hazardous Waste Sites and Schools</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="navbar has-shadow is-hidden-print">
  <div class="container">
    <div class="navbar-center"></div>
    <span id="navToggle" class="navbar-burger">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
              <a class="navbar-item is-tab "
                 href="https://nesanders.github.io/cawastemap/category/test.html">test</a>
        </div>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
  <section id="content" class="body">
    <article>
      <h1 class="title"><a href="https://nesanders.github.io/cawastemap/pages/maps.html" rel="bookmark"
         title="Permalink to Maps">Maps</a></h1>
      
      <div class="section"><h1>What are hazardous waste facilities? What are the health impacts?</h1>
<p>Hazardous waste facilities are regulated sites that are allowed to produce, treat, store, and dispose hazardous waste. In addition to the over 100 permitted sites throughout California, there are also hundreds of sites throughout the State that are undergoing cleanup, investigation, or enforcement for known or suspected contamination issues. These facilities and sites expose communities to a variety of chemicals that can increase the likelihood of cancer, respiratory diseases, neurological, reproductive, and developmental problems. </p>
<p>The environmental justice (EJ) movement rose in the 1970s from the group of residents in Warren County, North Carolina <a href="https://www.ucc.org/what-we-do/justice-local-church-ministries/justice/faithful-action-ministries/environmental-justice/a_movement_is_born_environmental_justice_and_the_ucc/">who fought against the disposal of polychlorinated biphenyls (PCBs) in their community</a>. This was one of the first prominent examples highlighting the disproportionate exposure to hazardous waste low-income communities of color face throughout the country. This fight also led to the seminal report by the United Church of Christâ€™s Commission for Racial Justice titled <a href="https://new.uccfiles.com/pdf/ToxicWastes&amp;Race.pdf"><em>Toxic Wastes and Race in the United States</em></a>.  This report, and other subsequent studies, have found that low-income communities and communities of color are more likely to live close to high-polluting industries, hazardous waste facilities, and incinerators. </p>
<h3>Direct embed</h3>
<!--<div>
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

<style>
    html, body {
        height: 100%;
        margin: 0;
    }
    .leaflet-container {
        height: 600px;
        width: 800px;
        max-width: 100%;
        max-height: 100%;
    }
</style>

<style>#map { width: 1200px; height: 600px; }
.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }</style>

<style type="text/css">
.leaflet-control {
max-height: 300px;
max-width: 600px;
overflow: auto;}
</style>

<div id='map'></div>

<script type="text/javascript" src="calenviroscreen.geojson"></script>

<script type="text/javascript" src="hzw_sites.geojson"></script>

<script type="text/javascript" src="public_schools.geojson"></script>

<script type="text/javascript" src="charter_schools.geojson"></script>

<script type="text/javascript" src="private_schools.geojson"></script>


<script type="text/javascript">

const map = L.map('map').setView([33.94, -118.24], 10);

const tiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    subdomains: 'abcd',
    maxZoom: 20,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
}).addTo(map);

// control that shows state info on hover
const info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info');
    info.showbasic();
    return this._div;
};
var selected = null;

info.showfull = function (props) {
    const tract = props ? props.Tract : 0;

    const approxLoc = props ? props.ApproxLoc : "";
    var hzwFocus = hzwSites.features.filter(function (el) {
        return el.properties.Tract == tract;
    });

    var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b><br><table><th>Project Name</th><th>Address</th><th>Site Type</th><th>Status</th><th>Past Uses</th>";
    for(let key in hzwFocus)
    {
        HTML += "<tr><td>"+hzwFocus[key].properties.PROJECT_NAME+"</td><td>"+hzwFocus[key].properties.ADDRESS+"</td><td>"+hzwFocus[key].properties.SITE_TYPE+"</td><td>"+hzwFocus[key].properties.STATUS+"</td><td>"+hzwFocus[key].properties.PAST_USES+"</td></tr>";
    }
    HTML += "</tr></table>";
    const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract';
    this._div.innerHTML = contents;
};

info.showbasic = function (props) {
    const tract = props ? props.Tract : 0;

    const approxLoc = props ? props.ApproxLoc : "";

    var hzwFocus = hzwSites.features.filter(function (el) {
        return el.properties.Tract == tract;
    });

    var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b> <br> There are "+hzwFocus.length+" sites in this census tract. Click on the tract for the full information about these sites.";
    const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract';
    this._div.innerHTML = contents;
};


info.addTo(map);

// get color depending on % BIPOC
function getColor(d) {
    return d > 0.90 ? '#573b88' :
        d > 0.77  ? '#834ba0' :
        d > 0.62  ? '#ad5fad' :
        d > 0.45  ? '#ce78b3' :
        d > 0.32   ? '#e597b9' :
        d > 0.21   ? '#f2b9c4' :
        d > 0   ? '#f9ddda' : '#D3D3D3';
}

function style(feature) {
    return {
        weight: 0.4,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7,
        fillColor: getColor(feature.properties.BIPOC)
    };
}

function highlightFeature(e) {
    const layer = e;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    /*layer.bringToFront();*/
    if (selected === null){
        info.showbasic(layer.feature.properties);
        }
}

/* global censusData */
const geojson = L.geoJson(censusData, {
    style,
    onEachFeature
}).addTo(map);

var publicSchoolMarkerOptions = {
    radius: 2,
    fillColor: "#FFD700",
    color: "#000",
    weight: 0,
    opacity: 1,
    fillOpacity: 0.8
};


const publicschools = L.geoJson(publicSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);


const charterschools = L.geoJson(charterSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);


const privateschools = L.geoJson(privateSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);

var geojsonMarkerOptions = {
    radius: 2,
    fillColor: "red",
    color: "#000",
    weight: 0,
    opacity: 1,
    fillOpacity: 0.8
};

/* global hzwsites */
const hzw = L.geoJson(hzwSites, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, geojsonMarkerOptions);
    }
}).addTo(map);


function resetHighlight(e) {
    const layer = e;
    if (selected === null || selected.feature.properties.Tract !== layer.feature.properties.Tract) {
        geojson.resetStyle(layer);
    }
}

function onClick(e) {
    const layer = e;
    if (selected !== null) {
        var previous = selected;
    }
    info.showfull(layer.feature.properties);
    selected = layer;
    if (previous && selected.feature.properties.Tract !== previous.feature.properties.Tract) {
        resetHighlight(previous);
        }
    else if (previous && selected.feature.properties.Tract == previous.feature.properties.Tract){
        selected = null;
        resetHighlight(previous);
        info.showbasic(previous.feature.properties);

    }
}

function onEachFeature(feature, layer) {
    layer.on({
        'mouseover': function (e) {
            highlightFeature(e.target);
        },
        'mouseout': function (e) {
            resetHighlight(e.target);
        },
        'click': function (e) {
            onClick(e.target);
        }
    });
}


var baseMaps = {
    "Basemap": tiles,
};

var overlayMaps = {
    "% BIPOC": geojson,
    "Hazardous Waste Sites": hzw,
    "Public Schools": publicschools,
    "Private Schools": privateschools,
    "Charter Schools": charterschools,


};

map.attributionControl.addAttribution('<a href="http://census.gov/">Population data</a>');
map.attributionControl.addAttribution('<a href="https://www.cde.ca.gov/schooldirectory/">Schools data</a>')

var layerControl = L.control.layers(baseMaps, overlayMaps, {position: 'bottomleft'}).addTo(map);

const legend = L.control({position: 'bottomright'});

legend.onAdd = function (map) {

    const div = L.DomUtil.create('div', 'info legend');
    const grades = [0, 0.21, 0.32, 0.45, 0.62, 0.77, 0.90];
    const labels = [];
    let from, to;

    for (let i = 0; i < grades.length; i++) {
        from = grades[i];
        to = grades[i + 1];

        labels.push(`<i style="background:${getColor(from+0.01)}"></i> ${from}${to ? `&ndash;${to}` : '+'}`);
    }

    div.innerHTML = labels.join('<br>');
    return div;
};

legend.addTo(map);

</script>
</div>-->

<!-- ### Include -->

<!DOCTYPE html>
<p><html lang="en">
<head>
<base target="_top">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"></p>
<p><title>Map1</title></p>
<p><link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" /></p>
<p><link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/></p>
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

<style>
    html, body {
        height: 100%;
        margin: 0;
    }
    .leaflet-container {
        height: 600px;
        width: 800px;
        max-width: 100%;
        max-height: 100%;
    }
</style>

<style>#map { width: 1200px; height: 600px; }
.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }</style>

<style type="text/css">
.leaflet-control {
max-height: 300px;
max-width: 600px;
overflow: auto;}
</style>

<p></head></p>
<body>

<div id='map'></div>

<script type="text/javascript" src="calenviroscreen.geojson"></script>

<script type="text/javascript" src="hzw_sites.geojson"></script>

<script type="text/javascript" src="public_schools.geojson"></script>

<script type="text/javascript" src="charter_schools.geojson"></script>

<script type="text/javascript" src="private_schools.geojson"></script>


<script type="text/javascript">

const map = L.map('map').setView([33.94, -118.24], 10);

const tiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    subdomains: 'abcd',
    maxZoom: 20,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
}).addTo(map);

// control that shows state info on hover
const info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info');
    info.showbasic();
    return this._div;
};
var selected = null;

info.showfull = function (props) {
    const tract = props ? props.Tract : 0;

    const approxLoc = props ? props.ApproxLoc : "";
    var hzwFocus = hzwSites.features.filter(function (el) {
        return el.properties.Tract == tract;
    });

    var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b><br><table><th>Project Name</th><th>Address</th><th>Site Type</th><th>Status</th><th>Past Uses</th>";
    for(let key in hzwFocus)
    {
        HTML += "<tr><td>"+hzwFocus[key].properties.PROJECT_NAME+"</td><td>"+hzwFocus[key].properties.ADDRESS+"</td><td>"+hzwFocus[key].properties.SITE_TYPE+"</td><td>"+hzwFocus[key].properties.STATUS+"</td><td>"+hzwFocus[key].properties.PAST_USES+"</td></tr>";
    }
    HTML += "</tr></table>";
    const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract';
    this._div.innerHTML = contents;
};

info.showbasic = function (props) {
    const tract = props ? props.Tract : 0;

    const approxLoc = props ? props.ApproxLoc : "";

    var hzwFocus = hzwSites.features.filter(function (el) {
        return el.properties.Tract == tract;
    });

    var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b> <br> There are "+hzwFocus.length+" sites in this census tract. Click on the tract for the full information about these sites.";
    const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract';
    this._div.innerHTML = contents;
};


info.addTo(map);

// get color depending on % BIPOC
function getColor(d) {
    return d > 0.90 ? '#573b88' :
        d > 0.77  ? '#834ba0' :
        d > 0.62  ? '#ad5fad' :
        d > 0.45  ? '#ce78b3' :
        d > 0.32   ? '#e597b9' :
        d > 0.21   ? '#f2b9c4' :
        d > 0   ? '#f9ddda' : '#D3D3D3';
}

function style(feature) {
    return {
        weight: 0.4,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7,
        fillColor: getColor(feature.properties.BIPOC)
    };
}

function highlightFeature(e) {
    const layer = e;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    /*layer.bringToFront();*/
    if (selected === null){
        info.showbasic(layer.feature.properties);
        }
}

/* global censusData */
const geojson = L.geoJson(censusData, {
    style,
    onEachFeature
}).addTo(map);

var publicSchoolMarkerOptions = {
    radius: 2,
    fillColor: "#FFD700",
    color: "#000",
    weight: 0,
    opacity: 1,
    fillOpacity: 0.8
};


const publicschools = L.geoJson(publicSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);


const charterschools = L.geoJson(charterSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);


const privateschools = L.geoJson(privateSchools, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, publicSchoolMarkerOptions);
    }
}).addTo(map);

var geojsonMarkerOptions = {
    radius: 2,
    fillColor: "red",
    color: "#000",
    weight: 0,
    opacity: 1,
    fillOpacity: 0.8
};

/* global hzwsites */
const hzw = L.geoJson(hzwSites, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, geojsonMarkerOptions);
    }
}).addTo(map);


function resetHighlight(e) {
    const layer = e;
    if (selected === null || selected.feature.properties.Tract !== layer.feature.properties.Tract) {
        geojson.resetStyle(layer);
    }
}

function onClick(e) {
    const layer = e;
    if (selected !== null) {
        var previous = selected;
    }
    info.showfull(layer.feature.properties);
    selected = layer;
    if (previous && selected.feature.properties.Tract !== previous.feature.properties.Tract) {
        resetHighlight(previous);
        }
    else if (previous && selected.feature.properties.Tract == previous.feature.properties.Tract){
        selected = null;
        resetHighlight(previous);
        info.showbasic(previous.feature.properties);

    }
}

function onEachFeature(feature, layer) {
    layer.on({
        'mouseover': function (e) {
            highlightFeature(e.target);
        },
        'mouseout': function (e) {
            resetHighlight(e.target);
        },
        'click': function (e) {
            onClick(e.target);
        }
    });
}


var baseMaps = {
    "Basemap": tiles,
};

var overlayMaps = {
    "% BIPOC": geojson,
    "Hazardous Waste Sites": hzw,
    "Public Schools": publicschools,
    "Private Schools": privateschools,
    "Charter Schools": charterschools,


};

map.attributionControl.addAttribution('<a href="http://census.gov/">Population data</a>');
map.attributionControl.addAttribution('<a href="https://www.cde.ca.gov/schooldirectory/">Schools data</a>')

var layerControl = L.control.layers(baseMaps, overlayMaps, {position: 'bottomleft'}).addTo(map);

const legend = L.control({position: 'bottomright'});

legend.onAdd = function (map) {

    const div = L.DomUtil.create('div', 'info legend');
    const grades = [0, 0.21, 0.32, 0.45, 0.62, 0.77, 0.90];
    const labels = [];
    let from, to;

    for (let i = 0; i < grades.length; i++) {
        from = grades[i];
        to = grades[i + 1];

        labels.push(`<i style="background:${getColor(from+0.01)}"></i> ${from}${to ? `&ndash;${to}` : '+'}`);
    }

    div.innerHTML = labels.join('<br>');
    return div;
};

legend.addTo(map);

</script>



</body>
<p></html></p>
<!--
### Image tag

![Map of race and facilities](../map1.html)-->

<h1>What is environmental racism?</h1>
<p>Since its inception, the EJ movement coined the concept of environmental racism to describe how Black, Indigenous, and communities of color (BIPOC) are disproportionately exposed to toxic and hazardous waste based on race. Environmental racism calls out the barriers, laws, regulations, and policies our government uses to allow the placement of and the unequal protection the government provides to BIPOC communities from the dangers of hazardous waste facilities. 
Southeast Los Angeles (SELA) provides an example of environmental racism in California. SELA communities abut the City of Vernon which hosts several hazardous waste facilities and several brownfields with known or potential contamination. These sites did not appear randomly but are rather a result of the intentional land use planning and laws which have allowed for multiple sources of hazardous waste to co-exist in or near BIPOC communities. </p>
<h1>Why these maps?</h1>
<p>The data on the hazardous waste facilities and sites throughout the State was obtained through the Department of Toxic Substances Controlâ€™s Envirostor database.</p>
<ol>
<li>Explain map of race and facilities v. map of schools with race v. map of Â¼ radius of hazardous waste sites to schools</li>
<li>Two GIS methods used</li>
</ol>
<h1>Why schools?</h1>
<p>School-age children spend a significant amount number of hours in schools. Every school day nearly 50.7 million school-aged children spend at least six hours in schools across the country. Many of these schools are located in close proximity to or at time, built on top of, hazardous waste sites.  As a result, the school locations are considered a key determinant of exposure to toxic pollutants. </p>
<p>Infants and children also have unique biological vulnerabilities and age-related patterns of exposure which make them more vulnerable to health impacts. For example, children consume more food, water, and breath more air per pound of body weight per day than an adult. Additionally, children are less able than adults to break down and excrete certain types of toxic compounds. Children also have more years of life than most adults and therefore have more time to develop chronic health conditions that could stem from early exposures. 
Environmental justice studies have found race and class inequities in the distribution of schoolchildren and schools near environmental hazards. In Los Angeles, minority students in LAUSD are more likely than their white counterparts to attend schools that are close to hazardous waste facilities. Latinos are more likely to attend schools near hazardous facilities and face higher health risks associated with toxic air emissions. 
US EPA created a Healthy School Environments Assessment Tool in 2006 to provide school districts guidance on the health and safety issues facing new and existing school sites. The guidance established guidelines to ensure childrenâ€™s environmental health concerns are considered in the siting, construction, and remediation of new schools.
A study based in Boston found that schools with disproportionately higher percentages of minority and economically disadvantaged schoolchildren are more likely to be located within a 1 mile radius Toxic Release Inventory (TRI) sites. The study also found a correlation between schools near TRI sites and low academic performance at the school level, as measured by English language art, math, and science Composite Performance Index scores.</p>
<h1>Gaps in hazardous waste law</h1>
<p>There are certain policies school districts in California must consider when deciding where to site new public schools. These policies have not changed since [20XX?] despite the increase development of charter schools in the state.</p>
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Map2</title>

    <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

    <style>
        html, body {
            height: 100%;
            margin: 0;
        }
        .leaflet-container {
            height: 600px;
            width: 800px;
            max-width: 100%;
            max-height: 100%;
        }
    </style>

    <style>#map { width: 1200px; height: 600px; }
.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }</style>

<style type="text/css">
.leaflet-control {
max-height: 300px;
max-width: 600px;
overflow: auto;}
</style>


</head>
<body>

<div id='map'></div>

<script type="text/javascript" src="calenviroscreen.geojson"></script>

<script type="text/javascript" src="hzw_near_schools.geojson"></script>

<script type="text/javascript" src="public_schools.geojson"></script>

<script type="text/javascript" src="charter_schools.geojson"></script>

<script type="text/javascript" src="private_schools.geojson"></script>


<script type="text/javascript">

    const map = L.map('map').setView([33.94, -118.24], 10);

    const tiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        subdomains: 'abcd',
        maxZoom: 20,
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
    }).addTo(map);

    // control that shows state info on hover
    const info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        info.showbasic();
        return this._div;
    };
    var selected = null;

    info.showfull = function (props) {
        const tract = props ? props.Tract : 0;

        const approxLoc = props ? props.ApproxLoc : "";
        var hzwFocus = hzwSites.features.filter(function (el) {
            return el.properties.Tract == tract;
        });

        var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b><br><table><th>Project Name</th><th>Address</th><th>Site Type</th><th>Status</th><th>Past Uses</th>";
        for(let key in hzwFocus)
        {
            HTML += "<tr><td>"+hzwFocus[key].properties.PROJECT_NAME+"</td><td>"+hzwFocus[key].properties.ADDRESS+"</td><td>"+hzwFocus[key].properties.SITE_TYPE+"</td><td>"+hzwFocus[key].properties.STATUS+"</td><td>"+hzwFocus[key].properties.PAST_USES+"</td></tr>";
        }
        HTML += "</tr></table>";
        const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract';
        this._div.innerHTML = contents;
    };

    info.showbasic = function (props) {
        const tract = props ? props.Tract : 0;

        const approxLoc = props ? props.ApproxLoc : "";

        var hzwFocus = hzwSites.features.filter(function (el) {
            return el.properties.Tract == tract;
        });

        var HTML = "<b>Hazardous Waste Sites for "+approxLoc+"</b> <br> There are "+hzwFocus.length+" sites in this census tract. Click on the tract for the full information about these sites.";
        const contents = hzwFocus.length ? HTML : 'Hover over/Click a census tract to see Hazardous Waste Sites';
        this._div.innerHTML = contents;
    };


    info.addTo(map);

    // get color depending on % BIPOC
    function getColor(d) {
        return d > 0.90 ? '#573b88' :
            d > 0.77  ? '#834ba0' :
            d > 0.62  ? '#ad5fad' :
            d > 0.45  ? '#ce78b3' :
            d > 0.32   ? '#e597b9' :
            d > 0.21   ? '#f2b9c4' :
            d > 0   ? '#f9ddda' : '#D3D3D3';
    }

    function style(feature) {
        return {
            weight: 0.4,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.7,
            fillColor: getColor(feature.properties.BIPOC)
        };
    }

    function highlightFeature(e) {
        const layer = e;

        layer.setStyle({
            weight: 5,
            color: '#666',
            dashArray: '',
            fillOpacity: 0.7
        });

        /*layer.bringToFront();*/
        if (selected === null){
            info.showbasic(layer.feature.properties);
            }
    }

    /* global censusData */
    const geojson = L.geoJson(censusData, {
        style,
        onEachFeature
    }).addTo(map);

    var publicSchoolMarkerOptions = {
        radius: 2,
        fillColor: "#FFD700",
        color: "#000",
        weight: 0,
        opacity: 1,
        fillOpacity: 0.8
    };


    const publicschools = L.geoJson(publicSchools, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, publicSchoolMarkerOptions);
        }
    }).addTo(map);


    const charterschools = L.geoJson(charterSchools, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, publicSchoolMarkerOptions);
        }
    }).addTo(map);


    const privateschools = L.geoJson(privateSchools, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, publicSchoolMarkerOptions);
        }
    }).addTo(map);

    var geojsonMarkerOptions = {
        radius: 2,
        fillColor: "red",
        color: "#000",
        weight: 0,
        opacity: 1,
        fillOpacity: 0.8
    };

    /* global hzwsites */
    const hzw = L.geoJson(hzwSites, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, geojsonMarkerOptions);
        }
    }).addTo(map);


    function resetHighlight(e) {
        const layer = e;
        if (selected === null || selected.feature.properties.Tract !== layer.feature.properties.Tract) {
            geojson.resetStyle(layer);
        }
    }

    function onClick(e) {
        const layer = e;
        if (selected !== null) {
            var previous = selected;
        }
        info.showfull(layer.feature.properties);
        selected = layer;
        if (previous && selected.feature.properties.Tract !== previous.feature.properties.Tract) {
            resetHighlight(previous);
            }
        else if (previous && selected.feature.properties.Tract == previous.feature.properties.Tract){
            selected = null;
            resetHighlight(previous);
            info.showbasic(previous.feature.properties);

        }
    }

    function onEachFeature(feature, layer) {
        layer.on({
            'mouseover': function (e) {
                highlightFeature(e.target);
            },
            'mouseout': function (e) {
                resetHighlight(e.target);
            },
            'click': function (e) {
                onClick(e.target);
            }
        });
    }


    var baseMaps = {
        "Basemap": tiles,
    };

    var overlayMaps = {
        "% BIPOC": geojson,
        "Hazardous Waste Sites": hzw,
        "Public Schools": publicschools,
        "Private Schools": privateschools,
        "Charter Schools": charterschools,


    };

    map.attributionControl.addAttribution('<a href="http://census.gov/">Population data</a>');
    map.attributionControl.addAttribution('<a href="https://www.cde.ca.gov/schooldirectory/">Schools data</a>')

    var layerControl = L.control.layers(baseMaps, overlayMaps, {position: 'bottomleft'}).addTo(map);

    const legend = L.control({position: 'bottomright'});

    legend.onAdd = function (map) {

        const div = L.DomUtil.create('div', 'info legend');
        const grades = [0, 0.21, 0.32, 0.45, 0.62, 0.77, 0.90];
        const labels = [];
        let from, to;

        for (let i = 0; i < grades.length; i++) {
            from = grades[i];
            to = grades[i + 1];

            labels.push(`<i style="background:${getColor(from+0.01)}"></i> ${from}${to ? `&ndash;${to}` : '+'}`);
        }

        div.innerHTML = labels.join('<br>');
        return div;
    };

    legend.addTo(map);

</script>



</body>
</html>
 -->
<!-- ![Map of schools with race](https://gluesolutions.github.io/map2.html) -->

<!-- ![Map of Â¼ radius of hazardous waste sites to schools](https://gluesolutions.github.io/map3.html) -->

<h2>Charter and private schools</h2>
<h2>Cudahy case study</h2>
<h1>Solutions</h1>
<p>In 2021-2022 state legislative cycle, Assemblymember Christina Garcia introduced AB 2214.</p>
<h1>Sources</h1>
<ol>
<li>Choi et al., 2006</li>
<li>Maantay et al., 2010; Brender et al., 2011; Johnson et al., 2016</li>
<li>National Center for Education Statistics 2018</li>
<li>Landrigan 2018</li>
<li>Pastor et al., 2002</li>
<li>Meng 2020</li>
</ol></div>
    </article>
  </section>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Other Pages</p>
          <ul class="menu-list">
                <li><a                        href="https://nesanders.github.io/cawastemap/pages/about.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
                <li><a class="is-active"                       href="https://nesanders.github.io/cawastemap/pages/maps.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">Maps</span>
                </a></li>
          </ul>
      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
    <div class="credits">
      <span><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a></span>
      <span><span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5</span>
      <span><span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3</span>
      <span>Made with <a href="https://bulma.io">Bulma</a></span>
    </div>
  </div>
  <div class="github-fork-ribbon-wrapper is-hidden-mobile is-hidden-print">
    <div class="github-fork-ribbon">
      <a href="https://github.com/nesanders/cawastemap">
        <i class="fa fa-github fa-fw"></i>
        Fork me on GitHub
      </a>
    </div>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'navbar-menu') {
      nav.className = 'navbar-menu is-active';
    } else {
      nav.className = 'navbar-menu';
    }
  });
</script>
</body>
</html>